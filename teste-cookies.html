<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste do Sistema de Cookies</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="src/css/style.css">
</head>
<body class="bg-gray-100 p-8">
    <div class="max-w-4xl mx-auto">
        <h1 class="text-3xl font-bold mb-6">Teste do Sistema de Cookies</h1>
        
        <div class="bg-white rounded-lg shadow p-6 mb-6">
            <h2 class="text-xl font-semibold mb-4">Controles de Teste</h2>
            <div class="space-y-4">
                <button id="test-show-banner" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">
                    Mostrar Banner de Cookies
                </button>
                <button id="test-show-modal" class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600">
                    Abrir Modal de Preferências
                </button>
                <button id="test-reset-cookies" class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600">
                    Resetar Todas as Configurações
                </button>
                <button id="test-check-status" class="bg-purple-500 text-white px-4 py-2 rounded hover:bg-purple-600">
                    Verificar Status dos Cookies
                </button>
                <button id="test-track-event" class="bg-yellow-500 text-white px-4 py-2 rounded hover:bg-yellow-600">
                    Testar Evento Analytics
                </button>
            </div>
        </div>

        <div class="bg-white rounded-lg shadow p-6">
            <h2 class="text-xl font-semibold mb-4">Status do Sistema</h2>
            <div id="status-display" class="bg-gray-50 p-4 rounded font-mono text-sm">
                <p>Carregando...</p>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="src/js/cookies.js"></script>
    <script src="src/js/analytics.js"></script>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const statusDisplay = document.getElementById('status-display');
            
            // Função para atualizar o status
            function updateStatus() {
                if (window.cookieManager) {
                    const status = {
                        'Cookie Manager': 'Carregado ✅',
                        'Consentimento Dado': window.cookieManager.hasUserMadeChoice() ? 'Sim ✅' : 'Não ❌',
                        'Cookies Necessários': window.cookieManager.isCookieTypeEnabled('necessary') ? 'Ativo ✅' : 'Inativo ❌',
                        'Cookies de Preferências': window.cookieManager.isCookieTypeEnabled('preferences') ? 'Ativo ✅' : 'Inativo ❌',
                        'Cookies de Análise': window.cookieManager.isCookieTypeEnabled('analytics') ? 'Ativo ✅' : 'Inativo ❌',
                        'Cookies de Marketing': window.cookieManager.isCookieTypeEnabled('marketing') ? 'Ativo ✅' : 'Inativo ❌',
                        'Analytics Manager': window.analyticsManager ? 'Carregado ✅' : 'Não Carregado ❌',
                        'LocalStorage': {
                            'cookieConsent': localStorage.getItem('cookieConsent') || 'Não definido',
                            'cookieConsentDate': localStorage.getItem('cookieConsentDate') || 'Não definido',
                            'cookiePreferences': localStorage.getItem('cookiePreferences') || 'Não definido'
                        }
                    };
                    
                    let html = '';
                    Object.keys(status).forEach(key => {
                        if (typeof status[key] === 'object') {
                            html += `<p><strong>${key}:</strong></p>`;
                            Object.keys(status[key]).forEach(subKey => {
                                html += `<p>&nbsp;&nbsp;${subKey}: ${status[key][subKey]}</p>`;
                            });
                        } else {
                            html += `<p><strong>${key}:</strong> ${status[key]}</p>`;
                        }
                    });
                    
                    statusDisplay.innerHTML = html;
                } else {
                    statusDisplay.innerHTML = '<p>Cookie Manager não carregado ainda...</p>';
                }
            }
            
            // Atualizar status a cada segundo
            setInterval(updateStatus, 1000);
            updateStatus();
            
            // Event listeners para botões de teste
            document.getElementById('test-show-banner').addEventListener('click', function() {
                if (window.cookieManager) {
                    window.cookieManager.showCookieBanner();
                }
            });
            
            document.getElementById('test-show-modal').addEventListener('click', function() {
                if (window.cookieManager) {
                    window.cookieManager.showPreferencesModal();
                }
            });
            
            document.getElementById('test-reset-cookies').addEventListener('click', function() {
                localStorage.removeItem('cookieConsent');
                localStorage.removeItem('cookieConsentDate');
                localStorage.removeItem('cookiePreferences');
                localStorage.removeItem('theme');
                alert('Configurações resetadas! Recarregue a página para ver o banner novamente.');
            });
            
            document.getElementById('test-check-status').addEventListener('click', function() {
                updateStatus();
                alert('Status atualizado!');
            });
            
            document.getElementById('test-track-event').addEventListener('click', function() {
                if (window.trackEvent) {
                    window.trackEvent('test_event', 'Test Category', 'Test Button Click');
                    alert('Evento de teste enviado (se analytics estiver habilitado)!');
                } else {
                    alert('Função trackEvent não disponível!');
                }
            });
        });
    </script>
</body>
</html>
